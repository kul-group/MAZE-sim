

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="Docutils 0.17: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Introductory MAZE Tutorial &mdash; MAZE 0.1 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Optimization Tutorial" href="../optimization_tutorial/optimization_tutorial.html" />
    <link rel="prev" title="Tutorials" href="../tutorial_index.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> MAZE
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../background.html">Background</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../tutorial_index.html">Tutorials</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Introductory MAZE Tutorial</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#verify-installation">Verify Installation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#cif-fetching-from-the-database-of-zeolite-structures">Cif Fetching from the Database of Zeolite Structures</a></li>
<li class="toctree-l3"><a class="reference internal" href="#making-a-zeolite-using-the-make-function">Making a Zeolite Using the Make Function</a></li>
<li class="toctree-l3"><a class="reference internal" href="#one-step-zeolite-construction">One Step Zeolite Construction</a></li>
<li class="toctree-l3"><a class="reference internal" href="#identifying-atom-types-in-a-zeolite-structure">Identifying Atom Types in a Zeolite Structure</a></li>
<li class="toctree-l3"><a class="reference internal" href="#extracting-adding-and-capping-clusters">Extracting, Adding and Capping Clusters</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../optimization_tutorial/optimization_tutorial.html">Optimization Tutorial</a></li>
<li class="toctree-l2"><a class="reference internal" href="../adsorbate.html">Adsorbate Class Tutorial</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../design_pattern.html">MAZE Index Mapper</a></li>
<li class="toctree-l1"><a class="reference internal" href="../key_classes.html">MAZE Key Classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../source.html">MAZE Modules</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">MAZE</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../tutorial_index.html">Tutorials</a> &raquo;</li>
        
      <li>Introductory MAZE Tutorial</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/intro_tutorial/intro_tutorial.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <section id="introductory-maze-tutorial">
<h1>Introductory MAZE Tutorial<a class="headerlink" href="#introductory-maze-tutorial" title="Permalink to this headline">¶</a></h1>
<p>These tutorials showcase the capabilities of the MAZE code, along with comments describing how to use the functions shown in the demos.</p>
<section id="verify-installation">
<h2>Verify Installation<a class="headerlink" href="#verify-installation" title="Permalink to this headline">¶</a></h2>
<p>Verify the installation by importing maze and making a simple empty
Zeolite</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>import maze
maze.Zeolite()
</pre></div>
</div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Zeolite(symbols=&#39;&#39;, pbc=False)
</pre></div>
</div>
</section>
<hr class="docutils" />
<section id="cif-fetching-from-the-database-of-zeolite-structures">
<h2>Cif Fetching from the Database of Zeolite Structures<a class="headerlink" href="#cif-fetching-from-the-database-of-zeolite-structures" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference external" href="http://www.iza-structure.org/databases/">database of zeolite structures</a> is a useful resource for zeolite simulation experiments. It contains cif files for all synthesized zeolites, organized by their three letter zeolite code. Downloading them from the website is easy when working on a local machine, but challenging when working on a remote machine. To facilitate smoother workflows, a simple python function which downloads cif files from the database was created. An example of using this to download a few different cif files is shown below.</p>
<p><strong>Note:</strong> Some users have had trouble using the <code class="docutils literal notranslate"><span class="pre">cif_download</span></code> function and the <code class="docutils literal notranslate"><span class="pre">make</span></code> method. The cause of this issue is typically latency issues with the IZA database’s website. If you encounter these issues you can download all of the CIF files in the database by going to this <a class="reference external" href="https://drive.google.com/file/d/1-sw5rdKWSUd0a9f1RzbCgjMzCRoUvmJl/view?usp=sharing">google drive link</a>, downloading the zip folder and extracting the <cite>data</cite> folder. Place this data folder in your working directory. You can see your working directory by running the python command <code class="docutils literal notranslate"><span class="pre">import</span> <span class="pre">os</span></code> followed by <code class="docutils literal notranslate"><span class="pre">print(os.getcwd())</span></code>.  After placing the <code class="docutils literal notranslate"><span class="pre">data</span></code> folder, which contains all of the CIF files from the IZA database, in your working directory, you will be able to run the <cite>make</cite> command without accessing the IZA database.</p>
<p>First, we import the MAZE package, the glob package, and the <code class="docutils literal notranslate"><span class="pre">download_cif</span></code> function from the <code class="docutils literal notranslate"><span class="pre">maze.cif_download</span></code> module.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">maze</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">maze.cif_download</span> <span class="kn">import</span> <span class="n">download_cif</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">glob</span>
</pre></div>
</div>
<p>Next, we declare a helper function which prints out all of the directories in the current working directory. This will help us visualize the <code class="docutils literal notranslate"><span class="pre">download_cif</span></code> function’s behavior.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">print_dirs</span><span class="p">():</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;dirs in cwd&#39;</span><span class="p">,</span>  <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s1">&#39;**/&#39;</span><span class="p">))</span>
<span class="gp">...</span>
</pre></div>
</div>
<p>We can view the directories names in our current directory using our helper function.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">print_dirs</span><span class="p">()</span>
<span class="go">dirs in cwd []</span>
</pre></div>
</div>
<p>Now, let’s download the GOO cif file, using the <code class="docutils literal notranslate"><span class="pre">download_cif</span></code> function. By default, the cif file is downloaded to the <cite>data</cite> directory; if this ‘data’ directory doesn’t exist, it is created.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">download_cif</span><span class="p">(</span><span class="s2">&quot;GOO&quot;</span><span class="p">)</span> <span class="c1"># downloads &quot;GOO.cif&quot; to data/GOO.cif</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">print_dirs</span><span class="p">()</span>
<span class="go">dirs in cwd [&#39;data/&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;files in data dir&#39;</span><span class="p">,</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s2">&quot;data/*&quot;</span><span class="p">))</span>
<span class="go">files in data dir [&#39;data/goo.cif&#39;]</span>
</pre></div>
</div>
<p>We can download the cif file to a custom location by specifying the directory we want to use:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">download_cif</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">,</span> <span class="n">data_dir</span><span class="o">=</span><span class="s2">&quot;my_other_data&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">print_dirs</span><span class="p">()</span>
<span class="go">dirs in cwd [&#39;my_other_data/&#39;, &#39;data/&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;files in my_other_data dir&#39;</span><span class="p">,</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s2">&quot;my_other_data/*&quot;</span><span class="p">))</span>
<span class="go">files in my_other_data dir [&#39;my_other_data/off.cif&#39;]</span>
</pre></div>
</div>
</section>
<hr class="docutils" />
<section id="making-a-zeolite-using-the-make-function">
<h2>Making a Zeolite Using the Make Function<a class="headerlink" href="#making-a-zeolite-using-the-make-function" title="Permalink to this headline">¶</a></h2>
<p>A cif file contains the crystallographic information that defines a
zeolite structure. A downloaded cif from the iza-sc database of zeolite
strucutres looks like this:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>#**************************************************************************
#
# cif taken from the iza-sc database of zeolite structures
# ch. baerlocher and l.b. mccusker
# database of zeolite structures: http://www.iza-structure.org/databases/
#
# the atom coordinates and the cell parameters were optimized with dls76
# assuming a pure sio2 composition.
#
#**************************************************************************

_cell_length_a                  13.6750(0)
_cell_length_b                  13.6750(0)
_cell_length_c                  14.7670(0)
_cell_angle_alpha               90.0000(0)
_cell_angle_beta                90.0000(0)
_cell_angle_gamma              120.0000(0)

_symmetry_space_group_name_h-m     &#39;r -3 m&#39;
_symmetry_int_tables_number         166
_symmetry_cell_setting             trigonal

loop_
_symmetry_equiv_pos_as_xyz
&#39;+x,+y,+z&#39;
&#39;2/3+x,1/3+y,1/3+z&#39;
&#39;1/3+x,2/3+y,2/3+z&#39;
&#39;-y,+x-y,+z&#39;
... skipping all of this info for space
...

loop_
_atom_site_label
_atom_site_type_symbol
_atom_site_fract_x
_atom_site_fract_y
_atom_site_fract_z
    o1    o     0.9020    0.0980    0.1227
    o2    o     0.9767    0.3101    0.1667
    o3    o     0.1203    0.2405    0.1315
    o4    o     0.0000    0.2577    0.0000
    t1    si    0.9997    0.2264    0.1051
</pre></div>
</div>
<p>An important piece of information in each cif file is the
_atom_site_label (01, 02, … t1, t2.. ect.) that is located in the first
column near the atom position information. This information about the
atoms identities is lost when the <code class="docutils literal notranslate"><span class="pre">ase.io.read</span></code> function is used to
build an atoms object from a cif file. Because the identity of the
T-sites is critical for zeolite simulation experiments, this issue
inspired the creation of a custom constructor of the <code class="docutils literal notranslate"><span class="pre">Zeolite</span></code> object:
<code class="docutils literal notranslate"><span class="pre">make</span></code>. This static method creates a <code class="docutils literal notranslate"><span class="pre">Zeolite</span></code> object, labels the
unique atoms by tagging them, and then stores the mapping between the
<code class="docutils literal notranslate"><span class="pre">atom_site_label</span></code> and the atom indices in the dictionaries
<code class="docutils literal notranslate"><span class="pre">site_to_atom_indices</span></code> and <code class="docutils literal notranslate"><span class="pre">atom_indices_to_site</span></code>.</p>
<p>To demonstrate this feature, let us try building a <code class="docutils literal notranslate"><span class="pre">Zeolite</span></code> object
from a cif file.</p>
<p>First, we import the MAZE package, the cif_download function and the
Zeolite object</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>import maze
from maze.cif_download import download_cif
</pre></div>
</div>
<p>Next we import some ase packages to help us view the Zeolites we make.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>import matplotlib.pyplot as plt
from ase.visualize.plot import plot_atoms
</pre></div>
</div>
<p>First we use the download_cif function to fetch the <code class="docutils literal notranslate"><span class="pre">CHA.cif</span></code> file from the IZA database.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>download_cif(&#39;CHA&#39;, data_dir=&#39;data&#39;)
</pre></div>
</div>
<p>Now we can use the static <code class="docutils literal notranslate"><span class="pre">make</span></code> method to <code class="docutils literal notranslate"><span class="pre">Zeolite</span></code> with labeled
atoms.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>cha_zeolite = Zeolite.make(&#39;CHA&#39;, data_dir=&#39;data&#39;)
</pre></div>
</div>
<p>Our <code class="docutils literal notranslate"><span class="pre">Zeolite</span></code> object has been built. We can view it with the ase
plot_atoms method (or view method). This works flawlessly because the
<code class="docutils literal notranslate"><span class="pre">Zeolite</span></code> class is a subclass of the <code class="docutils literal notranslate"><span class="pre">Atoms</span></code> class.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>plot_atoms(cha_zeolite)
</pre></div>
</div>
<img alt="../_images/output_17_1.png" src="../_images/output_17_1.png" />
<p>The atom identity information is stored in two dictionaries. Let’s take
a look at them:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>print(cha_zeolite.site_to_atom_indices)
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;O1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">17</span><span class="p">],</span> <span class="s1">&#39;O2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">18</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">26</span><span class="p">,</span> <span class="mi">27</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">29</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">33</span><span class="p">,</span> <span class="mi">34</span><span class="p">,</span> <span class="mi">35</span><span class="p">],</span> <span class="s1">&#39;O3&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">36</span><span class="p">,</span> <span class="mi">37</span><span class="p">,</span> <span class="mi">38</span><span class="p">,</span> <span class="mi">39</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">41</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">43</span><span class="p">,</span> <span class="mi">44</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">46</span><span class="p">,</span> <span class="mi">47</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span> <span class="mi">49</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">51</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">53</span><span class="p">],</span> <span class="s1">&#39;O4&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">54</span><span class="p">,</span> <span class="mi">55</span><span class="p">,</span> <span class="mi">56</span><span class="p">,</span> <span class="mi">57</span><span class="p">,</span> <span class="mi">58</span><span class="p">,</span> <span class="mi">59</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">61</span><span class="p">,</span> <span class="mi">62</span><span class="p">,</span> <span class="mi">63</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">65</span><span class="p">,</span> <span class="mi">66</span><span class="p">,</span> <span class="mi">67</span><span class="p">,</span> <span class="mi">68</span><span class="p">,</span> <span class="mi">69</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">71</span><span class="p">],</span> <span class="s1">&#39;T1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">72</span><span class="p">,</span> <span class="mi">73</span><span class="p">,</span> <span class="mi">74</span><span class="p">,</span> <span class="mi">75</span><span class="p">,</span> <span class="mi">76</span><span class="p">,</span> <span class="mi">77</span><span class="p">,</span> <span class="mi">78</span><span class="p">,</span> <span class="mi">79</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">81</span><span class="p">,</span> <span class="mi">82</span><span class="p">,</span> <span class="mi">83</span><span class="p">,</span> <span class="mi">84</span><span class="p">,</span> <span class="mi">85</span><span class="p">,</span> <span class="mi">86</span><span class="p">,</span> <span class="mi">87</span><span class="p">,</span> <span class="mi">88</span><span class="p">,</span> <span class="mi">89</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">91</span><span class="p">,</span> <span class="mi">92</span><span class="p">,</span> <span class="mi">93</span><span class="p">,</span> <span class="mi">94</span><span class="p">,</span> <span class="mi">95</span><span class="p">,</span> <span class="mi">96</span><span class="p">,</span> <span class="mi">97</span><span class="p">,</span> <span class="mi">98</span><span class="p">,</span> <span class="mi">99</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">102</span><span class="p">,</span> <span class="mi">103</span><span class="p">,</span> <span class="mi">104</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">106</span><span class="p">,</span> <span class="mi">107</span><span class="p">]}</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>print(cha_zeolite.atom_indices_to_sites)
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="s1">&#39;O1&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="s1">&#39;O1&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="s1">&#39;O1&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="s1">&#39;O1&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="s1">&#39;O1&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="s1">&#39;O1&#39;</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span> <span class="s1">&#39;O1&#39;</span><span class="p">,</span> <span class="mi">7</span><span class="p">:</span> <span class="s1">&#39;O1&#39;</span><span class="p">,</span> <span class="mi">8</span><span class="p">:</span> <span class="s1">&#39;O1&#39;</span><span class="p">,</span> <span class="mi">9</span><span class="p">:</span> <span class="s1">&#39;O1&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">:</span> <span class="s1">&#39;O1&#39;</span><span class="p">,</span> <span class="mi">11</span><span class="p">:</span> <span class="s1">&#39;O1&#39;</span><span class="p">,</span> <span class="mi">12</span><span class="p">:</span> <span class="s1">&#39;O1&#39;</span><span class="p">,</span> <span class="mi">13</span><span class="p">:</span> <span class="s1">&#39;O1&#39;</span><span class="p">,</span> <span class="mi">14</span><span class="p">:</span> <span class="s1">&#39;O1&#39;</span><span class="p">,</span> <span class="mi">15</span><span class="p">:</span> <span class="s1">&#39;O1&#39;</span><span class="p">,</span> <span class="mi">16</span><span class="p">:</span> <span class="s1">&#39;O1&#39;</span><span class="p">,</span> <span class="mi">17</span><span class="p">:</span> <span class="s1">&#39;O1&#39;</span><span class="p">,</span> <span class="mi">18</span><span class="p">:</span> <span class="s1">&#39;O2&#39;</span><span class="p">,</span> <span class="mi">19</span><span class="p">:</span> <span class="s1">&#39;O2&#39;</span><span class="p">,</span> <span class="mi">20</span><span class="p">:</span> <span class="s1">&#39;O2&#39;</span><span class="p">,</span> <span class="mi">21</span><span class="p">:</span> <span class="s1">&#39;O2&#39;</span><span class="p">,</span> <span class="mi">22</span><span class="p">:</span> <span class="s1">&#39;O2&#39;</span><span class="p">,</span> <span class="mi">23</span><span class="p">:</span> <span class="s1">&#39;O2&#39;</span><span class="p">,</span> <span class="mi">24</span><span class="p">:</span> <span class="s1">&#39;O2&#39;</span><span class="p">,</span> <span class="mi">25</span><span class="p">:</span> <span class="s1">&#39;O2&#39;</span><span class="p">,</span> <span class="mi">26</span><span class="p">:</span> <span class="s1">&#39;O2&#39;</span><span class="p">,</span> <span class="mi">27</span><span class="p">:</span> <span class="s1">&#39;O2&#39;</span><span class="p">,</span> <span class="mi">28</span><span class="p">:</span> <span class="s1">&#39;O2&#39;</span><span class="p">,</span> <span class="mi">29</span><span class="p">:</span> <span class="s1">&#39;O2&#39;</span><span class="p">,</span> <span class="mi">30</span><span class="p">:</span> <span class="s1">&#39;O2&#39;</span><span class="p">,</span> <span class="mi">31</span><span class="p">:</span> <span class="s1">&#39;O2&#39;</span><span class="p">,</span> <span class="mi">32</span><span class="p">:</span> <span class="s1">&#39;O2&#39;</span><span class="p">,</span> <span class="mi">33</span><span class="p">:</span> <span class="s1">&#39;O2&#39;</span><span class="p">,</span> <span class="mi">34</span><span class="p">:</span> <span class="s1">&#39;O2&#39;</span><span class="p">,</span> <span class="mi">35</span><span class="p">:</span> <span class="s1">&#39;O2&#39;</span><span class="p">,</span> <span class="mi">36</span><span class="p">:</span> <span class="s1">&#39;O3&#39;</span><span class="p">,</span> <span class="mi">37</span><span class="p">:</span> <span class="s1">&#39;O3&#39;</span><span class="p">,</span> <span class="mi">38</span><span class="p">:</span> <span class="s1">&#39;O3&#39;</span><span class="p">,</span> <span class="mi">39</span><span class="p">:</span> <span class="s1">&#39;O3&#39;</span><span class="p">,</span> <span class="mi">40</span><span class="p">:</span> <span class="s1">&#39;O3&#39;</span><span class="p">,</span> <span class="mi">41</span><span class="p">:</span> <span class="s1">&#39;O3&#39;</span><span class="p">,</span> <span class="mi">42</span><span class="p">:</span> <span class="s1">&#39;O3&#39;</span><span class="p">,</span> <span class="mi">43</span><span class="p">:</span> <span class="s1">&#39;O3&#39;</span><span class="p">,</span> <span class="mi">44</span><span class="p">:</span> <span class="s1">&#39;O3&#39;</span><span class="p">,</span> <span class="mi">45</span><span class="p">:</span> <span class="s1">&#39;O3&#39;</span><span class="p">,</span> <span class="mi">46</span><span class="p">:</span> <span class="s1">&#39;O3&#39;</span><span class="p">,</span> <span class="mi">47</span><span class="p">:</span> <span class="s1">&#39;O3&#39;</span><span class="p">,</span> <span class="mi">48</span><span class="p">:</span> <span class="s1">&#39;O3&#39;</span><span class="p">,</span> <span class="mi">49</span><span class="p">:</span> <span class="s1">&#39;O3&#39;</span><span class="p">,</span> <span class="mi">50</span><span class="p">:</span> <span class="s1">&#39;O3&#39;</span><span class="p">,</span> <span class="mi">51</span><span class="p">:</span> <span class="s1">&#39;O3&#39;</span><span class="p">,</span> <span class="mi">52</span><span class="p">:</span> <span class="s1">&#39;O3&#39;</span><span class="p">,</span> <span class="mi">53</span><span class="p">:</span> <span class="s1">&#39;O3&#39;</span><span class="p">,</span> <span class="mi">54</span><span class="p">:</span> <span class="s1">&#39;O4&#39;</span><span class="p">,</span> <span class="mi">55</span><span class="p">:</span> <span class="s1">&#39;O4&#39;</span><span class="p">,</span> <span class="mi">56</span><span class="p">:</span> <span class="s1">&#39;O4&#39;</span><span class="p">,</span> <span class="mi">57</span><span class="p">:</span> <span class="s1">&#39;O4&#39;</span><span class="p">,</span> <span class="mi">58</span><span class="p">:</span> <span class="s1">&#39;O4&#39;</span><span class="p">,</span> <span class="mi">59</span><span class="p">:</span> <span class="s1">&#39;O4&#39;</span><span class="p">,</span> <span class="mi">60</span><span class="p">:</span> <span class="s1">&#39;O4&#39;</span><span class="p">,</span> <span class="mi">61</span><span class="p">:</span> <span class="s1">&#39;O4&#39;</span><span class="p">,</span> <span class="mi">62</span><span class="p">:</span> <span class="s1">&#39;O4&#39;</span><span class="p">,</span> <span class="mi">63</span><span class="p">:</span> <span class="s1">&#39;O4&#39;</span><span class="p">,</span> <span class="mi">64</span><span class="p">:</span> <span class="s1">&#39;O4&#39;</span><span class="p">,</span> <span class="mi">65</span><span class="p">:</span> <span class="s1">&#39;O4&#39;</span><span class="p">,</span> <span class="mi">66</span><span class="p">:</span> <span class="s1">&#39;O4&#39;</span><span class="p">,</span> <span class="mi">67</span><span class="p">:</span> <span class="s1">&#39;O4&#39;</span><span class="p">,</span> <span class="mi">68</span><span class="p">:</span> <span class="s1">&#39;O4&#39;</span><span class="p">,</span> <span class="mi">69</span><span class="p">:</span> <span class="s1">&#39;O4&#39;</span><span class="p">,</span> <span class="mi">70</span><span class="p">:</span> <span class="s1">&#39;O4&#39;</span><span class="p">,</span> <span class="mi">71</span><span class="p">:</span> <span class="s1">&#39;O4&#39;</span><span class="p">,</span> <span class="mi">72</span><span class="p">:</span> <span class="s1">&#39;T1&#39;</span><span class="p">,</span> <span class="mi">73</span><span class="p">:</span> <span class="s1">&#39;T1&#39;</span><span class="p">,</span> <span class="mi">74</span><span class="p">:</span> <span class="s1">&#39;T1&#39;</span><span class="p">,</span> <span class="mi">75</span><span class="p">:</span> <span class="s1">&#39;T1&#39;</span><span class="p">,</span> <span class="mi">76</span><span class="p">:</span> <span class="s1">&#39;T1&#39;</span><span class="p">,</span> <span class="mi">77</span><span class="p">:</span> <span class="s1">&#39;T1&#39;</span><span class="p">,</span> <span class="mi">78</span><span class="p">:</span> <span class="s1">&#39;T1&#39;</span><span class="p">,</span> <span class="mi">79</span><span class="p">:</span> <span class="s1">&#39;T1&#39;</span><span class="p">,</span> <span class="mi">80</span><span class="p">:</span> <span class="s1">&#39;T1&#39;</span><span class="p">,</span> <span class="mi">81</span><span class="p">:</span> <span class="s1">&#39;T1&#39;</span><span class="p">,</span> <span class="mi">82</span><span class="p">:</span> <span class="s1">&#39;T1&#39;</span><span class="p">,</span> <span class="mi">83</span><span class="p">:</span> <span class="s1">&#39;T1&#39;</span><span class="p">,</span> <span class="mi">84</span><span class="p">:</span> <span class="s1">&#39;T1&#39;</span><span class="p">,</span> <span class="mi">85</span><span class="p">:</span> <span class="s1">&#39;T1&#39;</span><span class="p">,</span> <span class="mi">86</span><span class="p">:</span> <span class="s1">&#39;T1&#39;</span><span class="p">,</span> <span class="mi">87</span><span class="p">:</span> <span class="s1">&#39;T1&#39;</span><span class="p">,</span> <span class="mi">88</span><span class="p">:</span> <span class="s1">&#39;T1&#39;</span><span class="p">,</span> <span class="mi">89</span><span class="p">:</span> <span class="s1">&#39;T1&#39;</span><span class="p">,</span> <span class="mi">90</span><span class="p">:</span> <span class="s1">&#39;T1&#39;</span><span class="p">,</span> <span class="mi">91</span><span class="p">:</span> <span class="s1">&#39;T1&#39;</span><span class="p">,</span> <span class="mi">92</span><span class="p">:</span> <span class="s1">&#39;T1&#39;</span><span class="p">,</span> <span class="mi">93</span><span class="p">:</span> <span class="s1">&#39;T1&#39;</span><span class="p">,</span> <span class="mi">94</span><span class="p">:</span> <span class="s1">&#39;T1&#39;</span><span class="p">,</span> <span class="mi">95</span><span class="p">:</span> <span class="s1">&#39;T1&#39;</span><span class="p">,</span> <span class="mi">96</span><span class="p">:</span> <span class="s1">&#39;T1&#39;</span><span class="p">,</span> <span class="mi">97</span><span class="p">:</span> <span class="s1">&#39;T1&#39;</span><span class="p">,</span> <span class="mi">98</span><span class="p">:</span> <span class="s1">&#39;T1&#39;</span><span class="p">,</span> <span class="mi">99</span><span class="p">:</span> <span class="s1">&#39;T1&#39;</span><span class="p">,</span> <span class="mi">100</span><span class="p">:</span> <span class="s1">&#39;T1&#39;</span><span class="p">,</span> <span class="mi">101</span><span class="p">:</span> <span class="s1">&#39;T1&#39;</span><span class="p">,</span> <span class="mi">102</span><span class="p">:</span> <span class="s1">&#39;T1&#39;</span><span class="p">,</span> <span class="mi">103</span><span class="p">:</span> <span class="s1">&#39;T1&#39;</span><span class="p">,</span> <span class="mi">104</span><span class="p">:</span> <span class="s1">&#39;T1&#39;</span><span class="p">,</span> <span class="mi">105</span><span class="p">:</span> <span class="s1">&#39;T1&#39;</span><span class="p">,</span> <span class="mi">106</span><span class="p">:</span> <span class="s1">&#39;T1&#39;</span><span class="p">,</span> <span class="mi">107</span><span class="p">:</span> <span class="s1">&#39;T1&#39;</span><span class="p">}</span>
</pre></div>
</div>
<p>Depending on the situation, one dictionary may be more useful than the
other.</p>
</section>
<section id="one-step-zeolite-construction">
<h2>One Step Zeolite Construction<a class="headerlink" href="#one-step-zeolite-construction" title="Permalink to this headline">¶</a></h2>
<p>Downloading a cif file everytime you want to load a new Zeolite can be
annoying. Thus, the <code class="docutils literal notranslate"><span class="pre">make</span></code> function automatically downloads the cif
file from the IZA database if it cannot be located in the provided
directory. It places the downloaded cif file in folder called <code class="docutils literal notranslate"><span class="pre">data</span></code>
in the current working directory. Data paths can be specified with the
<code class="docutils literal notranslate"><span class="pre">data_dir</span></code> optional argument.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>bea_zeolite = Zeolite.make(&#39;BEA&#39;)  # Download the BEA cif file and build zeolite
plot_atoms(bea_zeolite)
</pre></div>
</div>
<img alt="../_images/output_23_1.png" src="../_images/output_23_1.png" />
</section>
<hr class="docutils" />
<section id="identifying-atom-types-in-a-zeolite-structure">
<h2>Identifying Atom Types in a Zeolite Structure<a class="headerlink" href="#identifying-atom-types-in-a-zeolite-structure" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">Zeotype</span></code> class includes methods for identifying the different
types of atoms in a zeolite structure. These methods will work on all
<code class="docutils literal notranslate"><span class="pre">Zeotype</span></code> objects, even those where the <code class="docutils literal notranslate"><span class="pre">atom_indices_to_site</span></code> and
<code class="docutils literal notranslate"><span class="pre">site_to_atom_indices</span></code> are not set.</p>
<p>Let’s import the Zeolite object and make a BEA structure and some tools
to visualize the structures we create.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>from maze import zeolite
import matplotlib.pyplot as plt
from ase.visualize.plot import plot_atoms
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>bea_zeolite = Zeolite.make(&#39;BEA&#39;)
plot_atoms(bea_zeolite)
</pre></div>
</div>
<img alt="../_images/output_30_1.png" src="../_images/output_30_1.png" />
<p>To make things more interesting, let us replace the Si-T1 sites in the
bea Zeolite with Aluminum.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>for t1_index in bea_zeolite.site_to_atom_indices[&#39;T1&#39;]:
    bea_zeolite[t1_index].symbol = &#39;Al&#39;
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>plot_atoms(bea_zeolite)
</pre></div>
</div>
<img alt="../_images/output_33_1.png" src="../_images/output_33_1.png" />
<p>Making a replacement is that simple! Now we will use the
<code class="docutils literal notranslate"><span class="pre">count_elements</span></code> method to get the count of each atom in the zeolite
and the idenity of each atom.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>atoms_indices, count = bea_zeolite.count_elements()
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>print(atoms_indices)
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;O&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">26</span><span class="p">,</span> <span class="mi">27</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">29</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">33</span><span class="p">,</span> <span class="mi">34</span><span class="p">,</span> <span class="mi">35</span><span class="p">,</span> <span class="mi">36</span><span class="p">,</span> <span class="mi">37</span><span class="p">,</span> <span class="mi">38</span><span class="p">,</span> <span class="mi">39</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">41</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">43</span><span class="p">,</span> <span class="mi">44</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">46</span><span class="p">,</span> <span class="mi">47</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span> <span class="mi">49</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">51</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">53</span><span class="p">,</span> <span class="mi">54</span><span class="p">,</span> <span class="mi">55</span><span class="p">,</span> <span class="mi">56</span><span class="p">,</span> <span class="mi">57</span><span class="p">,</span> <span class="mi">58</span><span class="p">,</span> <span class="mi">59</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">61</span><span class="p">,</span> <span class="mi">62</span><span class="p">,</span> <span class="mi">63</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">65</span><span class="p">,</span> <span class="mi">66</span><span class="p">,</span> <span class="mi">67</span><span class="p">,</span> <span class="mi">68</span><span class="p">,</span> <span class="mi">69</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">71</span><span class="p">,</span> <span class="mi">72</span><span class="p">,</span> <span class="mi">73</span><span class="p">,</span> <span class="mi">74</span><span class="p">,</span> <span class="mi">75</span><span class="p">,</span> <span class="mi">76</span><span class="p">,</span> <span class="mi">77</span><span class="p">,</span> <span class="mi">78</span><span class="p">,</span> <span class="mi">79</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">81</span><span class="p">,</span> <span class="mi">82</span><span class="p">,</span> <span class="mi">83</span><span class="p">,</span> <span class="mi">84</span><span class="p">,</span> <span class="mi">85</span><span class="p">,</span> <span class="mi">86</span><span class="p">,</span> <span class="mi">87</span><span class="p">,</span> <span class="mi">88</span><span class="p">,</span> <span class="mi">89</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">91</span><span class="p">,</span> <span class="mi">92</span><span class="p">,</span> <span class="mi">93</span><span class="p">,</span> <span class="mi">94</span><span class="p">,</span> <span class="mi">95</span><span class="p">,</span> <span class="mi">96</span><span class="p">,</span> <span class="mi">97</span><span class="p">,</span> <span class="mi">98</span><span class="p">,</span> <span class="mi">99</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">102</span><span class="p">,</span> <span class="mi">103</span><span class="p">,</span> <span class="mi">104</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">106</span><span class="p">,</span> <span class="mi">107</span><span class="p">,</span> <span class="mi">108</span><span class="p">,</span> <span class="mi">109</span><span class="p">,</span> <span class="mi">110</span><span class="p">,</span> <span class="mi">111</span><span class="p">,</span> <span class="mi">112</span><span class="p">,</span> <span class="mi">113</span><span class="p">,</span> <span class="mi">114</span><span class="p">,</span> <span class="mi">115</span><span class="p">,</span> <span class="mi">116</span><span class="p">,</span> <span class="mi">117</span><span class="p">,</span> <span class="mi">118</span><span class="p">,</span> <span class="mi">119</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">121</span><span class="p">,</span> <span class="mi">122</span><span class="p">,</span> <span class="mi">123</span><span class="p">,</span> <span class="mi">124</span><span class="p">,</span> <span class="mi">125</span><span class="p">,</span> <span class="mi">126</span><span class="p">,</span> <span class="mi">127</span><span class="p">],</span> <span class="s1">&#39;Al&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">128</span><span class="p">,</span> <span class="mi">129</span><span class="p">,</span> <span class="mi">130</span><span class="p">,</span> <span class="mi">131</span><span class="p">,</span> <span class="mi">132</span><span class="p">,</span> <span class="mi">133</span><span class="p">,</span> <span class="mi">134</span><span class="p">,</span> <span class="mi">135</span><span class="p">],</span> <span class="s1">&#39;Si&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">136</span><span class="p">,</span> <span class="mi">137</span><span class="p">,</span> <span class="mi">138</span><span class="p">,</span> <span class="mi">139</span><span class="p">,</span> <span class="mi">140</span><span class="p">,</span> <span class="mi">141</span><span class="p">,</span> <span class="mi">142</span><span class="p">,</span> <span class="mi">143</span><span class="p">,</span> <span class="mi">144</span><span class="p">,</span> <span class="mi">145</span><span class="p">,</span> <span class="mi">146</span><span class="p">,</span> <span class="mi">147</span><span class="p">,</span> <span class="mi">148</span><span class="p">,</span> <span class="mi">149</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">151</span><span class="p">,</span> <span class="mi">152</span><span class="p">,</span> <span class="mi">153</span><span class="p">,</span> <span class="mi">154</span><span class="p">,</span> <span class="mi">155</span><span class="p">,</span> <span class="mi">156</span><span class="p">,</span> <span class="mi">157</span><span class="p">,</span> <span class="mi">158</span><span class="p">,</span> <span class="mi">159</span><span class="p">,</span> <span class="mi">160</span><span class="p">,</span> <span class="mi">161</span><span class="p">,</span> <span class="mi">162</span><span class="p">,</span> <span class="mi">163</span><span class="p">,</span> <span class="mi">164</span><span class="p">,</span> <span class="mi">165</span><span class="p">,</span> <span class="mi">166</span><span class="p">,</span> <span class="mi">167</span><span class="p">,</span> <span class="mi">168</span><span class="p">,</span> <span class="mi">169</span><span class="p">,</span> <span class="mi">170</span><span class="p">,</span> <span class="mi">171</span><span class="p">,</span> <span class="mi">172</span><span class="p">,</span> <span class="mi">173</span><span class="p">,</span> <span class="mi">174</span><span class="p">,</span> <span class="mi">175</span><span class="p">,</span> <span class="mi">176</span><span class="p">,</span> <span class="mi">177</span><span class="p">,</span> <span class="mi">178</span><span class="p">,</span> <span class="mi">179</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">181</span><span class="p">,</span> <span class="mi">182</span><span class="p">,</span> <span class="mi">183</span><span class="p">,</span> <span class="mi">184</span><span class="p">,</span> <span class="mi">185</span><span class="p">,</span> <span class="mi">186</span><span class="p">,</span> <span class="mi">187</span><span class="p">,</span> <span class="mi">188</span><span class="p">,</span> <span class="mi">189</span><span class="p">,</span> <span class="mi">190</span><span class="p">,</span> <span class="mi">191</span><span class="p">]}</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>print(count)
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;O&#39;</span><span class="p">:</span> <span class="mi">128</span><span class="p">,</span> <span class="s1">&#39;Al&#39;</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span> <span class="s1">&#39;Si&#39;</span><span class="p">:</span> <span class="mi">56</span><span class="p">}</span>
</pre></div>
</div>
</section>
<hr class="docutils" />
<section id="extracting-adding-and-capping-clusters">
<h2>Extracting, Adding and Capping Clusters<a class="headerlink" href="#extracting-adding-and-capping-clusters" title="Permalink to this headline">¶</a></h2>
<p>One of the most useful features of the MAZE package is the ability to
add and remove atoms from a <code class="docutils literal notranslate"><span class="pre">Zeolite</span></code> object. To demonstrate this, we
will extract a cluster from an <code class="docutils literal notranslate"><span class="pre">Zeolite</span></code> object, change some of the
atoms, and then integrate it back into the main <code class="docutils literal notranslate"><span class="pre">Zeolite</span></code>.</p>
<p>First, we import the zeolite object and the plot_atoms function.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>from maze import zeolite
import matplotlib.pyplot as plt
from ase.visualize.plot import plot_atoms
</pre></div>
</div>
<p>Then we make a bea_zeolite object</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>bea_zeolite = Zeolite.make(&#39;BEA&#39;)
plot_atoms(bea_zeolite)
</pre></div>
</div>
<img alt="../_images/output_44_1.png" src="../_images/output_44_1.png" />
<p>The next step is to pick a T-site and then use one of the static methods
in the <code class="docutils literal notranslate"><span class="pre">Cluster</span></code> class to select indices to build the cluster.</p>
<p>The atom 154 is right in the middle of the zeolite, which will make
viewing the cluster creation easy. One could also use the
<code class="docutils literal notranslate"><span class="pre">site_to_atom_indices</span></code> dictionary to select a specific T site.</p>
<p>The Zeolite object uses a <code class="docutils literal notranslate"><span class="pre">ClusterMaker</span></code> object to select out certain
groups of atoms from the Zeolite.</p>
<p>By default a <code class="docutils literal notranslate"><span class="pre">DefaultClusterMaker</span></code> object is used. This
<code class="docutils literal notranslate"><span class="pre">DefaultClusterMaker</span></code> object has a <code class="docutils literal notranslate"><span class="pre">get_cluster_indices</span></code> method
which uses <code class="docutils literal notranslate"><span class="pre">get_oh_cluster_indices</span></code> function to selects the indices of
central t atom, and surrounding oxygens and hydrogens. There are other
cluster functions avalible in the source code of
<code class="docutils literal notranslate"><span class="pre">DefaultClusterMaker</span></code>. If you need some different functionality,
simply make your own ClusterMaker object and set the
<code class="docutils literal notranslate"><span class="pre">Zeolite.cluster_maker</span></code> attribute to your custom cluster maker.</p>
<p>Let us call our <code class="docutils literal notranslate"><span class="pre">bea_zeolite</span></code>’s <code class="docutils literal notranslate"><span class="pre">ClusterMaker</span></code> object’s
<code class="docutils literal notranslate"><span class="pre">get_cluster_indices</span></code> fun, to see what indices it will select.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>site = 154
cluster_indices = bea_zeolite.cluster_maker.get_cluster_indices(bea_zeolite, site)
print(cluster_indices)
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">66</span><span class="p">,</span> <span class="mi">74</span><span class="p">,</span> <span class="mi">138</span><span class="p">,</span> <span class="mi">77</span><span class="p">,</span> <span class="mi">82</span><span class="p">,</span> <span class="mi">146</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">154</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">38</span><span class="p">,</span> <span class="mi">102</span><span class="p">,</span> <span class="mi">186</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">174</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">114</span><span class="p">,</span> <span class="mi">117</span><span class="p">,</span> <span class="mi">118</span><span class="p">,</span> <span class="mi">58</span><span class="p">,</span> <span class="mi">126</span><span class="p">]</span>
</pre></div>
</div>
<p>These are the indices of the atoms that will make up the resulting
cluster and the indices of the atoms that will be absent in the open
defect zeolite.</p>
<p>We can now make the cluster and open defefect zeolites by using the
<code class="docutils literal notranslate"><span class="pre">get_cluster</span></code> method.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>cluster, od = bea_zeolite.get_cluster(154)
</pre></div>
</div>
<p>The cluster looks like this</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>plot_atoms(cluster)
</pre></div>
</div>
<img alt="../_images/output_50_1.png" src="../_images/output_50_1.png" />
<p>the open defect looks like this</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>plot_atoms(od)
</pre></div>
</div>
<img alt="../_images/output_52_1.png" src="../_images/output_52_1.png" />
<p>Both the open defect and the cluster are <code class="docutils literal notranslate"><span class="pre">Zeolite</span></code> objects, yet they
have a different ztype attribute</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>display(type(bea_zeolite))
display(type(od))
display(type(cluster))
</pre></div>
</div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>maze.zeolite.Zeolite
maze.zeolite.Zeolite
maze.zeolite.Zeolite
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>display(bea_zeolite.ztype)
display(od.ztype)
display(cluster.ztype)
</pre></div>
</div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>&#39;Zeolite&#39;
&#39;Open Defect&#39;
&#39;Cluster&#39;
</pre></div>
</div>
<p>Next we want to cap the cluster and changes some of the atoms its
structure. Capping involves adding hydrogens and oxygens to the cluster.
The built-in <code class="docutils literal notranslate"><span class="pre">cap_atoms()</span></code> method returns a new cluster object that
has hydrogen caps added to it.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>capped_cluster = cluster.cap_atoms()
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>plot_atoms(capped_cluster)
</pre></div>
</div>
<img alt="../_images/output_58_1.png" src="../_images/output_58_1.png" />
<p>In a typical zeolite workflow, this cluster would be optimized.
Configuring an optimizer can be tricky, and so for this tutorial we
instead replace the oxygen atoms with aluminum atoms.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>for atom in capped_cluster:
    if atom.symbol == &#39;O&#39;:
        capped_cluster[atom.index].symbol = &#39;Al&#39;
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>plot_atoms(capped_cluster)
</pre></div>
</div>
<img alt="../_images/output_61_1.png" src="../_images/output_61_1.png" />
<p>The next stage is removing the caps from the atom and reintegrating it
back into the original zeolite.</p>
<p>To remove caps, we have to find the name of the caps in <code class="docutils literal notranslate"><span class="pre">additions</span></code>
dictionary</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>dict(capped_cluster.additions)
</pre></div>
</div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>{&#39;h_caps&#39;: [&#39;h_caps_34&#39;]}
</pre></div>
</div>
<p>or we can just select the last h_caps added using pythons list methods</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>additon_category = &#39;h_caps&#39;
addition_name = capped_cluster.additions[additon_category][-1]
display(addition_name)
</pre></div>
</div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>&#39;h_caps_34&#39;
</pre></div>
</div>
<p>Next we call the remove_addition method</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>uncapped_cluster = capped_cluster.remove_addition(addition_name, additon_category)
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>plot_atoms(uncapped_cluster)
</pre></div>
</div>
<img alt="../_images/output_68_1.png" src="../_images/output_68_1.png" />
<p>The caps have been removed. We can now integrate the cluster back into
the original zeolite.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>bea_zeolite_with_al = bea_zeolite.integrate(uncapped_cluster)
plot_atoms(bea_zeolite_with_al)
</pre></div>
</div>
<img alt="../_images/output_71_1.png" src="../_images/output_71_1.png" />
<p>The changes have been made. An important thing to notice is that none of
the structural manipulation features of MAZE have side-effects. The
<code class="docutils literal notranslate"><span class="pre">bea_zeolite</span></code> remains unchanged by this integration and a new
<code class="docutils literal notranslate"><span class="pre">bea_zeolite_with_al</span></code> is created. Along with leading to cleaner code
with fewew bugs, this style of programming also allows for method
chanining.</p>
<p>This demo showed the power of the MAZE code to extract and add clusters
to zeotypes. This is one of the most useful features in the MAZE code.</p>
</section>
</section>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="../optimization_tutorial/optimization_tutorial.html" class="btn btn-neutral float-right" title="Optimization Tutorial" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="../tutorial_index.html" class="btn btn-neutral float-left" title="Tutorials" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2020, Dexter Antonio, Sam Holton.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>